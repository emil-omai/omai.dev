{{ define "main" }}
{{/* Check if this is a language homepage (sv or en) being rendered as a section */}}
{{ $isLanguageHomepage := false }}
{{ if or (eq .Section "sv") (eq .Section "en") }}
    {{/* If this is the root of a language section (homepage), render content */}}
    {{ if or (eq .RelPermalink "/sv/") (eq .RelPermalink "/en/") }}
        {{ $isLanguageHomepage = true }}
    {{ end }}
{{ end }}

{{ if $isLanguageHomepage }}
    {{/* This is a language homepage, render content */}}
    {{ .Content }}
{{ else }}
    {{/* This is a regular section page, list pages */}}
    {{ $currentLang := .Language.Lang }}
    {{ $isEnglish := or (eq $currentLang "en") (hasPrefix .RelPermalink "/en/") }}
    <div class="posts-page">
        <div class="posts-header">
            <h1>{{ .Title }}</h1>
        </div>
        
        <div class="posts-list">
            {{ range .Pages }}
            <article class="post-card">
                <div class="post-card-meta">
                    <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "2 January 2006" }}</time>
                </div>
                <h2 class="post-card-title">
                    <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                </h2>
                {{ if .Params.ingress }}
                <p class="post-card-ingress">{{ .Params.ingress }}</p>
                {{ end }}
                <a href="{{ .RelPermalink }}" class="post-card-link">{{ if $isEnglish }}Read more{{ else }}Läs mer{{ end }} →</a>
            </article>
            {{ end }}
        </div>
    </div>
{{ end }}
{{ end }}

